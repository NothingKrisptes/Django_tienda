{% extends 'tienda/base.html' %}

{% block content %}
<div style="max-width: 1000px; margin: 40px auto;">
    
    <!-- BREADCRUMB -->
    <div style="margin-bottom: 20px; font-size: 0.9rem;">
        <a href="{% url 'catalogo' %}" style="color: #666; text-decoration: none; font-weight: bold;">‚Üê Volver al cat√°logo</a>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 40px; background: #fff; padding: 40px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.1);">
        
        <!-- COLUMNA IZQUIERDA: IMAGEN -->
        <div>
            <div style="width: 100%; aspect-ratio: 1/1; border-radius: 12px; overflow: hidden; border: 1px solid #ddd; position: relative; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                {% if disco.porcentajeDescuento > 0 %}
                    <div style="position: absolute; top: 15px; right: 15px; background: #d32f2f; color: white; padding: 10px 15px; font-weight: bold; border-radius: 8px; font-size: 1rem; box-shadow: 0 3px 10px rgba(0,0,0,0.4); z-index: 10;">
                        -{{ disco.porcentajeDescuento }}% OFF
                    </div>
                {% endif %}
                
                {% if disco.imagenPortada %}
                    <img src="{{ disco.imagenPortada.url }}" style="width:100%; height:100%; object-fit:cover;">
                {% elif disco.imagenUrl %}
                    <img src="{{ disco.imagenUrl }}" style="width:100%; height:100%; object-fit:cover;">
                {% else %}
                    <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:#f5f5f5; color:#ccc; font-size:4rem;">‚ô´</div>
                {% endif %}
            </div>
        </div>

        <!-- COLUMNA DERECHA: INFORMACI√ìN -->
        <div>
            <h1 style="margin-top: 0; color: var(--secundario); font-family: 'Playfair Display', serif; font-size: 2.2rem;">{{ disco.tituloDisco }}</h1>
            <h3 style="margin: 10px 0 20px 0; color: #666; font-weight: 400; font-size: 1.3rem;">{{ disco.artistaPrincipal }}</h3>
            
            <!-- CATEGOR√çA -->
            <p style="background: #f5f5f5; padding: 6px 14px; border-radius: 20px; display: inline-block; font-size: 0.95rem; color: #555; margin-bottom: 20px;">
                üéµ {{ disco.categoria }}
            </p>

            <!-- PRECIO -->
           <div style="margin: 25px 0; padding: 20px 0; border-top: 1px solid #eee; border-bottom: 1px solid #eee;">
                {% if disco.porcentajeDescuento > 0 %}
                    <span style="font-size: 1.2rem; color: #999; text-decoration: line-through; display: block; margin-bottom: 5px;">${{ disco.precioUnitario|floatformat:2 }}</span>
                    <span style="font-size: 2.5rem; color: #d32f2f; font-weight: bold;">
                        ${{ disco.obtenerPrecioFinal|floatformat:2 }}
                    </span>
                    <span style="background: #ffebee; color: #d32f2f; padding: 4px 10px; border-radius: 5px; font-size: 0.9rem; margin-left: 10px; font-weight: bold;">
                        ¬°Ahorras ${{ disco.obtenerAhorro|floatformat:2 }}!
                    </span>
                {% else %}
                    <span style="font-size: 2.5rem; color: var(--acento); font-weight: bold;">
                        ${{ disco.precioUnitario }}
                    </span>
                {% endif %}
            </div>

            <!-- STOCK -->
            <div style="margin: 20px 0; font-size: 1rem;">
                {% if disco.stockDisponible > 0 %}
                    <span style="color: #388e3c; font-weight: bold; background: #e8f5e9; padding: 8px 15px; border-radius: 6px; display: inline-block;">
                        ‚úÖ Stock disponible: {{ disco.stockDisponible }} unidades
                    </span>
                {% else %}
                    <span style="color: #d32f2f; font-weight: bold; background: #ffebee; padding: 8px 15px; border-radius: 6px; display: inline-block;">
                        ‚ùå Producto agotado
                    </span>
                {% endif %}
            </div>

            <!-- BOT√ìN AGREGAR AL CARRITO -->
            {% if disco.stockDisponible > 0 %}
                <a href="{% url 'agregar_carrito' disco.id %}" class="btn" style="display: block; width: 100%; text-align: center; padding: 18px; font-size: 1.2rem; margin: 30px 0 10px 0; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                    üõí AGREGAR AL CARRITO
                </a>
            {% else %}
                <button disabled class="btn" style="width: 100%; background: #e0e0e0; color: #999; cursor: not-allowed; padding: 18px; font-size: 1.2rem;">
                    AGOTADO
                </button>
            {% endif %}

            <!-- DESCRIPCI√ìN (DESPLEGABLE) -->
            {% if disco.descripcion %}
                <details style="margin-top: 30px; border: 1px solid #eee; border-radius: 8px; padding: 15px; background: #f9f9f9;">
                    <summary style="cursor: pointer; font-weight: bold; color: var(--secundario); font-size: 1.1rem; padding: 5px;">
                        üìñ Sobre este √°lbum
                    </summary>
                    <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 6px; line-height: 1.8; color: #555;">
                        {{ disco.descripcion|linebreaks }}
                    </div>
                </details>
            {% endif %}

            <!-- LISTA DE CANCIONES (DESPLEGABLE) -->
            {% if disco.listaCanciones %}
                <details style="margin-top: 15px; border: 1px solid #eee; border-radius: 8px; padding: 15px; background: #f9f9f9;">
                    <summary style="cursor: pointer; font-weight: bold; color: var(--secundario); font-size: 1.1rem; padding: 5px;">
                        üé∂ Lista de Canciones
                    </summary>
                    <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 6px;">
                        <pre style="font-family: 'Lato', sans-serif; margin: 0; white-space: pre-wrap; line-height: 1.9; color: #555; font-size: 0.95rem;">{{ disco.listaCanciones }}</pre>
                    </div>
                </details>
            {% endif %}

            <!-- POL√çTICAS -->
            <div style="margin-top: 30px; padding: 20px; background: #f0f7ff; border-radius: 8px; border-left: 4px solid #2196f3;">
                <p style="margin: 0; font-size: 0.9rem; color: #555;">
                    <strong>üîÑ Pol√≠tica de Devoluciones:</strong> 
                    {% if disco.aceptaDevolucion %}
                        <span style="color: #2e7d32;">Tienes 7 d√≠as para devolver este producto.</span>
                    {% else %}
                        <span style="color: #d32f2f;">Este producto no acepta devoluciones.</span>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
